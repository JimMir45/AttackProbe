# BAS (Breach and Attack Simulation) 行业调研

> 版本: v2.0 | 调研日期: 2026-01-18 | 状态: 完成

## 1. BAS 概述

### 1.1 什么是 BAS

BAS (Breach and Attack Simulation，入侵与攻击模拟) 是一种**自动化安全验证技术**，通过安全地模拟真实世界的网络攻击来持续评估组织的安全防御能力。

与传统渗透测试不同，BAS 具有以下特点：
- **持续性**: 可以自动化、持续运行，而非一次性评估
- **安全性**: 模拟攻击不会造成实际破坏
- **全面性**: 覆盖完整攻击链，从初始访问到数据外泄
- **可量化**: 提供防护有效性评分和差距分析

### 1.2 BAS 核心价值

| 价值点 | 说明 |
|-------|------|
| 持续验证 | 不是一次性扫描，而是 7x24 持续的安全态势验证 |
| 攻击视角 | 从攻击者角度验证防护有效性，发现真实差距 |
| 量化指标 | 提供可量化的安全防护成功率，便于汇报 |
| 主动防御 | 从被动响应转向主动发现和修复 |

---

## 2. 目标行业深度分析

> 本项目聚焦 **金融、运营商、互联网** 三大行业，以下从多维度进行深度分析。

### 2.1 金融行业

#### 2.1.1 行业概述

| 维度 | 说明 |
|------|------|
| **细分领域** | 银行 (国有/股份/城商/农商)、证券、保险、基金、支付机构、消费金融 |
| **市场规模** | 银行业资产 400+ 万亿，证券业资产 13+ 万亿 (2025) |
| **数字化程度** | 高，核心系统国产化替代进行中，分布式架构转型 |
| **安全投入** | 信息科技投入占营收 3-5%，安全约占 IT 投入 8-15% |

#### 2.1.2 监管合规要求

| 监管要求 | 具体内容 | BAS 关联 |
|---------|---------|---------|
| **等保 2.0** | 三级及以上系统年度测评 | 需验证安全控制有效性 |
| **银保监会** | 《商业银行信息科技风险管理指引》 | 定期安全评估、渗透测试 |
| **人行** | 《金融数据安全分级指南》 | 数据分类分级、DLP 验证 |
| **证监会** | 《证券期货业网络安全管理办法》 | 攻防演练、应急响应 |
| **行业攻防演练** | 每年 HVV、金融专项行动 | BAS 提供持续验证能力 |

#### 2.1.3 典型 IT 架构

```
金融机构典型架构:

                        ┌─────────────────┐
                        │   互联网区       │
                        │ 网银/手机银行/API│
                        └────────┬────────┘
                                 │ WAF/防火墙
                        ┌────────▼────────┐
                        │    DMZ 区       │
                        │  Web服务器集群   │
                        └────────┬────────┘
                                 │ 防火墙/IPS
        ┌───────────────────────┼───────────────────────┐
        │                       │                       │
┌───────▼───────┐      ┌───────▼───────┐      ┌───────▼───────┐
│   办公网       │      │   生产网       │      │   开发测试网   │
│ OA/邮件/终端   │      │ 核心系统/数据库 │      │ 开发/测试环境  │
└───────────────┘      └───────────────┘      └───────────────┘
        │                       │                       │
        └───────────────────────┼───────────────────────┘
                                │
                        ┌───────▼───────┐
                        │   数据中心     │
                        │ 同城/异地灾备  │
                        └───────────────┘
```

**关键系统:**
- 核心银行系统 (Core Banking)
- 网银/手机银行
- 支付清算系统
- 信贷管理系统
- 反欺诈系统
- 客户信息系统 (CIF)

#### 2.1.4 安全组织与采购

| 维度 | 说明 |
|------|------|
| **安全团队规模** | 大行 200-500 人，中小行 20-50 人 |
| **组织架构** | 科技部下设安全处/室，或独立信息安全部 |
| **决策链** | 安全负责人 → 科技部总经理 → 分管副行长 |
| **采购周期** | 3-6 个月 (招投标流程) |
| **预算周期** | 年度预算制，Q3-Q4 编制下年预算 |
| **采购偏好** | 倾向国产化、私有化部署、有金融案例 |

#### 2.1.5 威胁情报

**针对金融行业的主要威胁组织:**

| APT 组织 | 来源 | 主要目标 | 常用技术 |
|---------|------|---------|---------|
| Lazarus (APT38) | 朝鲜 | SWIFT系统、加密货币 | 鱼叉钓鱼、供应链攻击 |
| Carbanak/FIN7 | 东欧 | POS系统、ATM | 钓鱼、横向移动 |
| Silence | 俄罗斯 | 银行内网 | 合法工具滥用 |
| 境内黑产 | 国内 | 客户数据、账户资金 | 撞库、钓鱼、内鬼 |

**近年典型攻击事件:**
- 孟加拉央行 SWIFT 攻击 (8100 万美元)
- 台湾银行 ATM 吐钞攻击
- 国内多起银行钓鱼导致的资金盗取
- 证券公司客户信息泄露事件

#### 2.1.6 BAS 应用场景

| 场景 | 验证目标 | 频率 | 优先级 |
|------|---------|------|-------|
| **网银安全验证** | WAF 规则、API 鉴权、业务逻辑 | 每月 | P0 |
| **钓鱼演练** | 员工安全意识、邮件网关 | 每季度 | P0 |
| **内网渗透验证** | 横向移动防护、特权账号管理 | 每季度 | P1 |
| **数据防泄漏验证** | DLP 策略、数据库审计 | 每月 | P0 |
| **HVV 前准备** | 全面安全验证 | 年度 | P0 |
| **勒索软件防护** | EDR、备份恢复 | 每季度 | P1 |
| **供应链安全** | 第三方接口、开源组件 | 每季度 | P1 |

---

### 2.2 运营商行业

#### 2.2.1 行业概述

| 维度 | 说明 |
|------|------|
| **主要企业** | 中国移动、中国电信、中国联通、广电 |
| **用户规模** | 移动用户 17+ 亿，宽带用户 6+ 亿 (2025) |
| **网络特点** | IT/CT 融合，网络架构复杂，覆盖范围广 |
| **转型方向** | 云网融合、5G 行业应用、算力网络 |
| **安全投入** | 安全投入占 IT 投入 5-10% |

#### 2.2.2 监管合规要求

| 监管要求 | 具体内容 | BAS 关联 |
|---------|---------|---------|
| **等保 2.0** | 关基保护、核心网络系统三级以上 | 安全控制验证 |
| **工信部** | 《电信和互联网用户个人信息保护规定》 | 用户数据保护验证 |
| **网信办** | 《关键信息基础设施安全保护条例》 | 关基系统持续验证 |
| **通信管理局** | 网络安全检查、专项行动 | 配合检查、整改验证 |
| **集团安全检查** | 年度安全评估、攻防演练 | BAS 支撑持续验证 |

#### 2.2.3 典型 IT 架构

```
运营商典型网络架构:

┌─────────────────────────────────────────────────────────────────┐
│                         IT 支撑网                               │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐ │
│  │  BSS 系统   │  │  OSS 系统   │  │     企业内网            │ │
│  │ 计费/CRM   │  │ 网管/资源   │  │   OA/邮件/办公         │ │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘ │
└─────────────────────────────┬───────────────────────────────────┘
                              │ 安全域隔离
┌─────────────────────────────▼───────────────────────────────────┐
│                         CT 网络                                  │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐ │
│  │  5G 核心网  │  │  传输网络   │  │     承载网络            │ │
│  │ AMF/SMF/UPF│  │ OTN/PTN    │  │   IP RAN/城域网        │ │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘ │
└─────────────────────────────┬───────────────────────────────────┘
                              │
┌─────────────────────────────▼───────────────────────────────────┐
│                        云网融合                                  │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐ │
│  │  运营商云   │  │   边缘计算   │  │     IDC 数据中心        │ │
│  │ 天翼云/移动云│  │   MEC      │  │   托管/云服务          │ │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

**关键系统:**
- BSS (Business Support System): 计费、CRM、营业
- OSS (Operation Support System): 网管、资源管理、故障管理
- 5G 核心网: AMF、SMF、UPF、NRF 等网元
- BOSS: 综合业务运营支撑系统
- 4A 系统: 账号、认证、授权、审计

#### 2.2.4 安全组织与采购

| 维度 | 说明 |
|------|------|
| **安全团队规模** | 集团 100-300 人，省公司 20-50 人 |
| **组织架构** | 网络与信息安全部 (独立一级部门) |
| **决策链** | 省安全部 → 集团安全部 → 采购部 |
| **采购模式** | 集团集采 + 省公司自采 |
| **采购周期** | 集采 6-12 个月，省采 3-6 个月 |
| **采购偏好** | 入围集采名录、有运营商案例、本地化服务 |

#### 2.2.5 威胁情报

**针对运营商的主要威胁:**

| 威胁类型 | 威胁组织/来源 | 主要目标 | 常用技术 |
|---------|-------------|---------|---------|
| 国家级 APT | 境外情报机构 | 核心网、用户数据 | 0day、供应链 |
| 网络设备漏洞 | 黑客组织 | 路由器、交换机 | 已知漏洞利用 |
| 供应链攻击 | 多方 | 设备供应商 | 固件后门、软件供应链 |
| 内部威胁 | 内部人员 | 用户数据、网络配置 | 权限滥用 |
| DDoS 攻击 | 黑产/竞争 | 网络服务 | 流量攻击 |

**典型安全事件:**
- 某运营商 HLR 数据泄露
- 5G 核心网设备安全漏洞
- SS7/Diameter 协议攻击
- 边缘计算平台入侵

#### 2.2.6 BAS 应用场景

| 场景 | 验证目标 | 频率 | 优先级 |
|------|---------|------|-------|
| **边界防护验证** | 防火墙、IPS、WAF 规则有效性 | 每月 | P0 |
| **BSS/OSS 安全** | Web 漏洞、API 安全、权限控制 | 每季度 | P0 |
| **IT-CT 隔离验证** | 域间隔离、访问控制策略 | 每季度 | P0 |
| **4A 系统验证** | 账号安全、特权管理、审计 | 每月 | P1 |
| **云平台安全** | 租户隔离、API 安全、配置合规 | 每月 | P1 |
| **5G 安全验证** | 核心网安全、边缘计算安全 | 每季度 | P1 |
| **供应链安全** | 设备安全、第三方接口 | 每季度 | P2 |

---

### 2.3 互联网行业

#### 2.3.1 行业概述

| 维度 | 说明 |
|------|------|
| **细分领域** | 电商、社交、内容、游戏、金融科技、企业服务、AI |
| **代表企业** | BAT、字节、美团、京东、拼多多、网易、B站等 |
| **技术特点** | 云原生、微服务、DevOps、AI 驱动 |
| **安全投入** | 头部企业安全团队 500-2000 人，中腰部 50-200 人 |
| **安全成熟度** | 差异大，头部成熟，中小企业安全债务重 |

#### 2.3.2 监管合规要求

| 监管要求 | 具体内容 | BAS 关联 |
|---------|---------|---------|
| **等保 2.0** | 用户数据系统三级以上 | 安全控制验证 |
| **个人信息保护法** | 用户数据保护、跨境传输 | 数据安全验证 |
| **数据安全法** | 数据分类分级、安全评估 | 数据防泄漏验证 |
| **网络安全审查** | 关键业务系统审查 | 配合审查、持续验证 |
| **APP 合规** | 隐私政策、权限收集 | 移动端安全验证 |
| **AI 监管** | 算法备案、内容安全 | LLM 安全验证 |

#### 2.3.3 典型 IT 架构

```
互联网企业典型架构:

┌─────────────────────────────────────────────────────────────────┐
│                         流量入口层                               │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐ │
│  │    CDN      │  │   WAF/DDoS  │  │      负载均衡           │ │
│  │  边缘节点   │  │   防护      │  │   SLB/CLB/ALB         │ │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘ │
└─────────────────────────────┬───────────────────────────────────┘
                              │
┌─────────────────────────────▼───────────────────────────────────┐
│                         应用服务层                               │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐ │
│  │  API 网关   │  │  微服务集群  │  │     Serverless         │ │
│  │ Kong/APISIX │  │ K8s/容器    │  │   函数计算/云函数       │ │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘ │
└─────────────────────────────┬───────────────────────────────────┘
                              │
┌─────────────────────────────▼───────────────────────────────────┐
│                         数据存储层                               │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐ │
│  │   关系数据库 │  │   NoSQL     │  │     大数据平台          │ │
│  │ MySQL/PG   │  │ Redis/Mongo │  │   Hadoop/Spark/Flink   │ │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘ │
└─────────────────────────────┬───────────────────────────────────┘
                              │
┌─────────────────────────────▼───────────────────────────────────┐
│                          AI/ML 层                                │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐ │
│  │  训练平台   │  │  推理服务   │  │      LLM 应用           │ │
│  │ GPU 集群   │  │ TensorRT   │  │   RAG/Agent/Chatbot    │ │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

**关键系统:**
- 用户中心 (账号、认证、权限)
- 交易系统 (订单、支付、结算)
- 内容系统 (UGC、推荐、审核)
- 数据平台 (用户画像、数据分析)
- AI 平台 (模型训练、推理服务、LLM 应用)

#### 2.3.4 安全组织与采购

| 维度 | 说明 |
|------|------|
| **安全团队规模** | 头部 500-2000 人，中腰部 50-200 人，小型 5-20 人 |
| **组织架构** | 独立安全部门，或归属技术/基础设施部门 |
| **决策链** | 安全负责人 → CTO/技术VP → CEO (重大项目) |
| **采购模式** | 灵活，云服务优先，POC 验证 |
| **采购周期** | 1-3 个月 (快速决策) |
| **采购偏好** | 云原生、API 友好、可编程、开源优先 |

#### 2.3.5 威胁情报

**针对互联网企业的主要威胁:**

| 威胁类型 | 威胁来源 | 主要目标 | 常用技术 |
|---------|---------|---------|---------|
| 黑灰产 | 国内外黑产 | 用户数据、业务薅羊毛 | 撞库、爬虫、自动化攻击 |
| 竞争对手 | 商业竞争 | 商业数据、用户 | 爬虫、内鬼 |
| 供应链攻击 | 多方 | 开源组件、CI/CD | 恶意包、代码注入 |
| 勒索攻击 | 勒索团伙 | 业务系统、数据 | 加密勒索 |
| LLM 攻击 | 多方 | AI 应用 | 提示词注入、越狱 |

**近年典型安全事件:**
- 某电商平台用户数据泄露
- 某社交平台 API 被滥用爬取数据
- 某公司 CI/CD 被攻击导致代码泄露
- 多起 LLM 应用被越狱事件
- 某游戏公司遭勒索攻击

#### 2.3.6 BAS 应用场景

| 场景 | 验证目标 | 频率 | 优先级 |
|------|---------|------|-------|
| **API 安全验证** | 认证授权、限流、数据脱敏 | 持续 (CI/CD 集成) | P0 |
| **Web 安全验证** | OWASP Top 10、业务逻辑 | 每周/每版本 | P0 |
| **云安全验证** | IAM、安全组、存储桶权限 | 每周 | P0 |
| **容器安全验证** | 镜像安全、K8s 配置、运行时 | 每周 | P0 |
| **LLM 安全验证** | 提示词注入、越狱、数据泄露 | 每版本 | P0 |
| **供应链安全** | SCA、CI/CD 安全、依赖检查 | 持续 | P1 |
| **数据安全验证** | 数据脱敏、访问控制、审计 | 每月 | P1 |
| **账号安全验证** | 撞库防护、MFA、风控 | 每月 | P1 |

---

### 2.4 三大行业对比总结

| 维度 | 金融 | 运营商 | 互联网 |
|------|------|-------|-------|
| **监管强度** | ★★★★★ | ★★★★ | ★★★ |
| **安全预算** | ★★★★★ | ★★★★ | ★★★ (差异大) |
| **采购周期** | 3-6 月 | 3-12 月 | 1-3 月 |
| **部署偏好** | 私有化 | 私有化 | 云/混合 |
| **技术栈** | 传统+分布式 | IT+CT | 云原生 |
| **LLM 需求** | ★★ | ★★ | ★★★★★ |
| **合规驱动** | ★★★★★ | ★★★★ | ★★★ |
| **BAS 成熟度** | 中高 | 中 | 中低 |

**各行业 BAS 核心诉求:**

| 行业 | 核心诉求 |
|------|---------|
| **金融** | 合规驱动、HVV 准备、数据防泄漏、勒索防护 |
| **运营商** | 边界防护、IT-CT 隔离、集团安全检查、5G 安全 |
| **互联网** | DevSecOps 集成、API/云/容器安全、LLM 安全、快速迭代 |

---

## 3. 市场格局

### 3.1 主要厂商

| 厂商 | 产品 | 特点 | 评分 |
|------|------|------|------|
| Picus Security | Picus Platform | 攻击库丰富，检测验证强 | 9.0/10 |
| Cymulate | Cymulate Platform | 全面的攻击向量覆盖 | 8.8/10 |
| SafeBreach | SafeBreach Platform | "数字孪生"方法，Hacker's Playbook | 8.5/10 |
| AttackIQ | AttackIQ Platform | AI/ML 组件测试，Anatomic Engine | 8.3/10 |
| Pentera | Pentera Platform | 自动化渗透测试 | 8.2/10 |
| Horizon3.ai | NodeZero | 自主渗透测试 | 8.0/10 |

> 数据来源: PeerSpot 2025年12月排名

### 3.2 开源方案

| 项目 | 用途 | 链接 |
|------|------|------|
| MITRE Caldera | 自动化对手模拟 | https://caldera.mitre.org |
| Atomic Red Team | ATT&CK 技术测试库 | https://atomicredteam.io |
| Infection Monkey | 自动化渗透测试 | https://www.akamai.com/infectionmonkey |
| Garak (NVIDIA) | LLM 安全测试 | https://github.com/leondz/garak |

---

## 4. MITRE ATT&CK 覆盖策略

### 4.1 覆盖率说明

MITRE ATT&CK Enterprise 包含 **14 个战术、203 个技术、453 个子技术**。

**我们的策略: 务实覆盖 50%，其余提供技术原理文档**

| 覆盖类型 | 技术数量 | 说明 |
|---------|---------|------|
| **直接覆盖** | ~100 个 (50%) | 自动化模拟执行 |
| **原理文档** | ~100 个 (50%) | 技术原理 + 手动验证指南 |
| **不适用** | ~3 个 | 物理攻击等无法模拟 |

### 4.2 直接覆盖的技术 (50%)

基于金融、运营商、互联网三大目标行业需求，优先覆盖以下技术：

#### 第一优先级 - 核心 50 技术

| 战术 | 技术 ID | 技术名称 | 金融 | 运营商 | 互联网 |
|------|--------|---------|------|-------|-------|
| **Initial Access** | T1566 | Phishing | ★★★ | ★★ | ★★ |
| | T1190 | Exploit Public-Facing App | ★★★ | ★★★ | ★★★ |
| | T1078 | Valid Accounts | ★★★ | ★★ | ★★★ |
| **Execution** | T1059 | Command and Scripting | ★★ | ★★ | ★★ |
| | T1204 | User Execution | ★★★ | ★★ | ★★ |
| **Persistence** | T1547 | Boot/Logon Autostart | ★★ | ★★ | ★ |
| | T1053 | Scheduled Task/Job | ★★ | ★★ | ★★ |
| | T1136 | Create Account | ★★ | ★★ | ★★★ |
| **Privilege Escalation** | T1548 | Abuse Elevation Control | ★★ | ★★ | ★★ |
| | T1068 | Exploitation for Privilege | ★★ | ★★ | ★★ |
| **Defense Evasion** | T1027 | Obfuscated Files | ★★ | ★★ | ★ |
| | T1070 | Indicator Removal | ★★ | ★★ | ★★ |
| | T1055 | Process Injection | ★★ | ★ | ★ |
| **Credential Access** | T1003 | OS Credential Dumping | ★★★ | ★★ | ★ |
| | T1110 | Brute Force | ★★★ | ★★ | ★★★ |
| | T1552 | Unsecured Credentials | ★★★ | ★★ | ★★★ |
| **Discovery** | T1082 | System Information | ★★ | ★★ | ★★ |
| | T1083 | File and Directory | ★★ | ★★ | ★★ |
| | T1046 | Network Service Scan | ★★ | ★★★ | ★★ |
| **Lateral Movement** | T1021 | Remote Services | ★★ | ★★★ | ★★ |
| | T1570 | Lateral Tool Transfer | ★★ | ★★★ | ★★ |
| **Collection** | T1005 | Data from Local System | ★★★ | ★★ | ★★★ |
| | T1560 | Archive Collected Data | ★★ | ★★ | ★★ |
| **C2** | T1071 | Application Layer Protocol | ★★ | ★★ | ★★ |
| | T1105 | Ingress Tool Transfer | ★★ | ★★ | ★★ |
| **Exfiltration** | T1041 | Exfiltration Over C2 | ★★★ | ★★ | ★★★ |
| | T1048 | Exfiltration Over Alternative | ★★★ | ★★ | ★★ |
| **Impact** | T1486 | Data Encrypted (Ransomware) | ★★★ | ★★ | ★★ |
| | T1489 | Service Stop | ★★ | ★★★ | ★★★ |

#### 第二优先级 - 扩展 50 技术

包括但不限于：
- Web 攻击相关技术 (OWASP Top 10 映射)
- 云环境攻击技术
- 容器/K8s 相关技术
- API 安全相关技术

### 4.3 未直接覆盖的技术 (50%)

**未覆盖原因分类:**

| 原因 | 技术示例 | 处理方式 |
|------|---------|---------|
| **环境依赖** | T1558 Kerberoasting (需AD) | 提供技术原理 + 环境搭建指南 |
| **破坏性高** | T1485 Data Destruction | 仅标记模拟，提供验证方法 |
| **硬件依赖** | T1200 Hardware Additions | 提供检测建议，无法模拟 |
| **复杂度高** | T1557 MITM | 规划中，定制开发可支持 |
| **场景特殊** | T1195 Supply Chain | 提供检测方法，无法完全模拟 |

**技术原理文档包含:**
1. 攻击技术详解
2. 真实案例分析
3. 手动验证步骤
4. 防护建议
5. 检测方法

**定制开发说明:**
对于"规划中"和"定制开发可支持"的技术，企业客户可通过定制开发服务获得支持。

---

## 5. 技术架构

### 5.1 三层架构模型

```
┌─────────────────────────────────────────────────────────────────┐
│                    SCE Orchestrator Layer                        │
│                      (编排层)                                    │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐  │
│  │ 威胁情报库   │  │混沌实验设计器│  │    攻击树生成器         │  │
│  │ (TTP库)     │  │             │  │  (Attack Tree Gen)      │  │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘  │
└───────────────────────────┬─────────────────────────────────────┘
                            │ API
┌───────────────────────────▼─────────────────────────────────────┐
│                      Connector Layer                             │
│                       (连接层)                                   │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐  │
│  │ 状态获取器   │  │ 操作管理器   │  │    结果收集器           │  │
│  │State Fetcher│  │Op Manager   │  │  Result Retriever       │  │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘  │
└───────────────────────────┬─────────────────────────────────────┘
                            │ API
┌───────────────────────────▼─────────────────────────────────────┐
│                        BAS Layer                                 │
│                       (执行层)                                   │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐  │
│  │   Agents    │  │  Abilities  │  │     Operations          │  │
│  │  (执行代理) │  │  (攻击能力) │  │   (攻击操作)            │  │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

### 5.2 核心组件

| 组件 | 职责 | 实现方式 |
|------|------|---------|
| **威胁情报库** | 存储 TTP (战术/技术/过程) | MITRE ATT&CK 映射 |
| **攻击树生成器** | 构建攻击路径 | 基于对手画像生成 |
| **Agent** | 在目标环境执行攻击 | 轻量级可执行程序 |
| **Abilities** | 具体攻击动作/技术 | 脚本/Payload |
| **判定引擎** | 评估攻击是否被防护 | 规则/关键词/AI |

---

## 6. 功能模块

### 6.1 完整 BAS 平台模块

```
完整 BAS 平台
│
├── 传统安全 BAS
│   ├── 网络攻击模拟 (Network Attack)
│   │   ├── 网络渗透/端口扫描
│   │   ├── 防火墙规则绕过
│   │   ├── IDS/IPS 检测测试
│   │   └── 网络分段验证
│   │
│   ├── 端点攻击模拟 (Endpoint Attack)
│   │   ├── 恶意软件模拟 (Ransomware, RAT, Rootkit)
│   │   ├── EDR/AV 绕过测试
│   │   ├── 权限提升
│   │   └── 进程注入
│   │
│   ├── Web 攻击模拟 (Web Attack)
│   │   ├── OWASP Top 10 (XSS, SQLi, SSRF...)
│   │   ├── WAF 绕过测试
│   │   ├── API 安全测试
│   │   └── 认证/授权绕过
│   │
│   ├── 邮件攻击模拟 (Email Attack)
│   │   ├── 钓鱼邮件模拟
│   │   ├── 恶意附件测试
│   │   ├── 邮件网关绕过
│   │   └── BEC 攻击模拟
│   │
│   └── 数据泄露模拟 (Data Exfiltration)
│       ├── DLP 测试
│       ├── 隐蔽通道 (DNS/HTTPS隧道)
│       └── 云存储外泄
│
├── LLM 安全 BAS (差异化能力)
│   ├── Prompt Injection (提示词注入)
│   ├── Jailbreak (越狱攻击)
│   ├── Info Disclosure (敏感信息泄露)
│   ├── Training Data Extraction (训练数据提取)
│   └── Model Denial of Service (模型拒绝服务)
│
├── 安全控制验证
│   ├── NGFW/防火墙有效性
│   ├── WAF/Web应用防火墙
│   ├── IDS/IPS 检测率
│   ├── EDR/XDR 响应
│   ├── SIEM 告警覆盖
│   ├── DLP 数据防泄漏
│   └── Email Gateway 邮件网关
│
└── 报告与集成
    ├── ATT&CK 热力图
    ├── 防护有效性评分
    ├── 差距分析报告
    ├── 修复建议
    └── SIEM/SOAR 集成
```

### 6.2 功能优先级 (三大目标行业)

| 优先级 | 功能 | 金融 | 运营商 | 互联网 | 说明 |
|-------|------|------|-------|-------|------|
| P0 | LLM 安全模块 | ★★ | ★★ | ★★★ | 已有，差异化竞争力 |
| P0 | Web/API 攻击模拟 | ★★★ | ★★ | ★★★ | 网银/门户/API 安全 |
| P0 | 钓鱼模拟 | ★★★ | ★★ | ★★ | 员工安全意识 |
| P1 | 网络攻击模拟 | ★★ | ★★★ | ★★ | 边界防护 |
| P1 | ATT&CK 映射 | ★★★ | ★★★ | ★★ | 合规要求 |
| P1 | 数据泄露模拟 | ★★★ | ★★★ | ★★★ | DLP 验证 |
| P1 | 云安全验证 | ★★ | ★★ | ★★★ | 云原生环境 |
| P2 | 端点攻击模拟 | ★★ | ★★ | ★ | 需要 Agent |
| P2 | 邮件攻击模拟 | ★★ | ★ | ★ | 需要邮件基础设施 |
| P2 | 容器/K8s 安全 | ★ | ★★ | ★★★ | 云原生架构 |
| P3 | SIEM/SOAR 集成 | ★★★ | ★★★ | ★★ | 企业级需求 |

---

## 7. 产品定位

### 7.1 差异化定位

| 竞品 | 我们的差异 |
|------|-----------|
| 商业 BAS (Picus, Cymulate) | 开源/私有化部署，价格优势，国产化 |
| 开源 BAS (Caldera) | 更易用的 UI，LLM 安全独有，中文支持 |
| LLM 安全工具 (Garak) | 更完整的 BAS 能力，企业级功能 |

**定位**: **面向金融、运营商、互联网行业的开源 BAS 平台，整合传统安全 + LLM 安全验证能力**

### 7.2 技术选型建议

| 组件 | 建议方案 | 原因 |
|------|---------|------|
| 攻击库格式 | YAML + MITRE ATT&CK ID | 标准化、可扩展 |
| Agent 架构 | Go 编译单文件 | 轻量、跨平台 |
| 报告格式 | Markdown + PDF | 灵活、专业 |
| API 标准 | OpenAPI 3.0 | 便于集成 |

---

## 8. 参考资料

- [MITRE ATT&CK Framework](https://attack.mitre.org/)
- [MITRE Caldera](https://caldera.mitre.org/)
- [Picus Security](https://www.picussecurity.com/)
- [Cymulate](https://cymulate.com/)
- [SafeBreach](https://www.safebreach.com/)
- [BAS Architecture Research (arXiv)](https://arxiv.org/html/2508.03882)
- [PeerSpot BAS Rankings 2025](https://www.peerspot.com/categories/breach-and-attack-simulation-bas)

---

## 变更记录

| 日期 | 版本 | 变更内容 | 作者 |
|------|------|---------|------|
| 2026-01-18 | v1.0 | 初稿创建 | SecOps Team |
| 2026-01-18 | v1.1 | 增加目标行业分析，明确50%覆盖策略 | SecOps Team |
| 2026-01-18 | v1.2 | 补充互联网行业分析，完善三大目标行业覆盖 | SecOps Team |
| 2026-01-18 | v2.0 | 深度重写目标行业分析，增加架构、监管、威胁情报、采购等维度 | SecOps Team |
